# Vicmap2PGSQL

Python and OGR based importer for VicMap datasets to a PostGIS database.


## How to use it?

First, download the desired VicMap datasets. The download format should
be in ESRI Shapefile, GDA94 projection (note: this is the fastest format
which is generated by data.vic.gov.au and Spatial Datamart. Other formats
can take lengthy delays before the download is available.). Extract the
datasets into a folder with the same name as the source dataset, keeping
the original directory structure intact. For instance, for the VMPLAN
dataset, the extracted files should be split between "VMPLAN\layer" and
"VMPLAN\table".

Setup your connection parameters to the destination PostGIS database, eg
by setting the environment variables:

- PGHOST
- PGPORT
- PGDATABASE
- PGUSER
- PGPASSWORD

You may also need to set an environment variable pointing to your OGR2OGR
path, eg

    SET OGR2OGR=C:\OSGeo4W64\bin\ogr2ogr.exe

To import a dataset, run

    python src/import.py DATASET_PATH

or 

    python src/import.py DATASET_PATH LAYER_NAME

eg.

`python src/import.py d:\vicmap\VMTRANS` will import all Vicmap transport
datasets from the zipfile extracted to `d:\vicmap\VMTRANS`.

`python src/import.py d:\vicmap\VMTRANS tr_road` will import just the 
`tr_roads` dataset from the zipfile extract.

## Optional arguments

Supported optional arguments are:

* `--recreate` forces any existing Postgres tables to be dropped and 
re-created before the import. This option should be used with care,
but is useful to upgrade table definitions if either the importer
data structure mapping or source VicMap table structure changes.

* `--skipshpimport` bypasses the first step of importing the source
shapefile to the Postgres public schema, prior to transformation into
the final table destination. This option is used to aid debugging, as
the initial shapefile import step can be time-consuming.

## Supported datasets

Currently supported datasets are:

- PTV
- VMADD
- VMADMIN
- VMCLTENURE
- VMELEV
- VMFEAT
- VMHYDRO
- VMIMAGERY (CIP IWS Footprints)
- VMINDEX
- Melway Map Indexes
- VMLITE
- VMPLAN
- VMPROP
- VMREFTAB
- VMTRANS
- VMVEG

Additional supported layers:

- plm25

More to come...
